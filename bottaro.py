import random
import nest_asyncio
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, filters, ContextTypes, ConversationHandler
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ nest_asyncio
nest_asyncio.apply()
# –°–ª–æ–≤–∞—Ä—å —Å –∫–∞—Ä—Ç–∞–º–∏ –¢–∞—Ä–æ –∏ –∏—Ö –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
tarot_cards = {
    "0": ("–î—É—Ä–∞–∫", "–ù–æ–≤—ã–µ –Ω–∞—á–∏–Ω–∞–Ω–∏—è, —Å–≤–æ–±–æ–¥–∞, —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ—Å—Ç—å.",
          "–î—É—Ä–∞–∫ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ –Ω–∞—á–∏–Ω–∞–Ω–∏—è –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –º–∏—Ä —Å –æ—Ç–∫—Ä—ã—Ç—ã–º —Å–µ—Ä–¥—Ü–µ–º. –û–Ω –ø—Ä–∏–∑—ã–≤–∞–µ—Ç –≤–∞—Å —Å–ª–µ–¥–æ–≤–∞—Ç—å —Å–≤–æ–∏–º –∏–Ω—Å—Ç–∏–Ω–∫—Ç–∞–º –∏ –Ω–µ –±–æ—è—Ç—å—Å—è —Ä–∏—Å–∫–æ–≤–∞—Ç—å."),
    "I": ("–ú–∞–≥", "–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, —É–º–µ–Ω–∏–µ, —Ä–µ—Å—É—Ä—Å–Ω–æ—Å—Ç—å.",
          "–ú–∞–≥ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∏–ª—É –≤–æ–ª–∏ –∏ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ. –û–Ω –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –≤–∞–º –æ –≤–∞—à–∏—Ö —Ç–∞–ª–∞–Ω—Ç–∞—Ö –∏ –æ —Ç–æ–º, –∫–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å–≤–æ–∏—Ö —Ü–µ–ª–µ–π."),
    "II": ("–ñ—Ä–∏—Ü–∞", "–ò–Ω—Ç—É–∏—Ü–∏—è, —Ç–∞–π–Ω—ã, –∂–µ–Ω—Å–∫–∞—è –º—É–¥—Ä–æ—Å—Ç—å.",
           "–ñ—Ä–∏—Ü–∞ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∏–Ω—Ç—É–∏—Ü–∏—é –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ. –û–Ω–∞ –ø—Ä–∏–∑—ã–≤–∞–µ—Ç –≤–∞—Å –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ —Å–≤–æ–∏ —á—É–≤—Å—Ç–≤–∞ –∏ –∏–Ω—Å—Ç–∏–Ω–∫—Ç—ã, –∞ —Ç–∞–∫–∂–µ –∏—Å–∫–∞—Ç—å –∑–Ω–∞–Ω–∏—è –≤ —Ç–∏—à–∏–Ω–µ."),
    "III": ("–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞", "–ü–ª–æ–¥–æ—Ä–æ–¥–∏–µ, –ø—Ä–∏—Ä–æ–¥–∞, –∏–∑–æ–±–∏–ª–∏–µ.",
            "–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±–∏–ª–∏–µ, –º–∞—Ç–µ—Ä–∏–Ω—Å—Ç–≤–æ –∏ –∑–∞–±–æ—Ç—É. –û–Ω–∞ –æ–ª–∏—Ü–µ—Ç–≤–æ—Ä—è–µ—Ç –ø—Ä–∏—Ä–æ–¥—É –∏ –ø–ª–æ–¥–æ—Ä–æ–¥–∏–µ."),
    "IV": ("–ò–º–ø–µ—Ä–∞—Ç–æ—Ä", "–°—Ç—Ä—É–∫—Ç—É—Ä–∞, –≤–ª–∞—Å—Ç—å, —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ.",
            "–ò–º–ø–µ—Ä–∞—Ç–æ—Ä —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. –≠—Ç–æ –∫–∞—Ä—Ç–∞ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è."),
    "V": ("–ò–µ—Ä–æ—Ñ–∞–Ω—Ç", "–¢—Ä–∞–¥–∏—Ü–∏—è, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å, —É—á–µ–Ω–∏–µ.",
           "–ò–µ—Ä–æ—Ñ–∞–Ω—Ç –æ–ª–∏—Ü–µ—Ç–≤–æ—Ä—è–µ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏ –¥—É—Ö–æ–≤–Ω—ã–µ –ø–æ–∏—Å–∫–∏. –û–Ω –ø—Ä–∏–∑—ã–≤–∞–µ—Ç –≤–∞—Å –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Å–≤–æ–µ–º—É –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —è."),
    "VI": ("–í–ª—é–±–ª–µ–Ω–Ω—ã–µ", "–õ—é–±–æ–≤—å, –≥–∞—Ä–º–æ–Ω–∏—è, –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ.",
            "–í–ª—é–±–ª–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Å–≤—è–∑—å –∏ –≥–∞—Ä–º–æ–Ω–∏—é. –≠—Ç–∞ –∫–∞—Ä—Ç–∞ –≥–æ–≤–æ—Ä–∏—Ç –æ –≤–∞–∂–Ω–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–æ–≤ –≤ –ª—é–±–≤–∏."),
    "VII": ("–ö–æ–ª–µ—Å–Ω–∏—Ü–∞", "–ü–æ–±–µ–¥–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –≤–æ–ª—è.",
             "–ö–æ–ª–µ—Å–Ω–∏—Ü–∞ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–±–µ–¥—É –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å. –í—ã —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ —Å–≤–æ–µ–π —Å—É–¥—å–±–æ–π –∏ —É—Å–ø–µ—Ö–æ–º."),
    "VIII": ("–°–∏–ª–∞", "–°–º–µ–ª–æ—Å—Ç—å, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ.",
             "–°–∏–ª–∞ –æ–ª–∏—Ü–µ—Ç–≤–æ—Ä—è–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å–∏–ª—É –∏ —Å–º–µ–ª–æ—Å—Ç—å. –≠—Ç–æ –ø—Ä–∏–∑—ã–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ."),
    "IX": ("–û—Ç—à–µ–ª—å–Ω–∏–∫", "–ü–æ–∏—Å–∫ –∏—Å—Ç–∏–Ω—ã, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–∏—Ä.",
            "–û—Ç—à–µ–ª—å–Ω–∏–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–∏—Å–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∏—Å—Ç–∏–Ω—ã. –≠—Ç–æ –≤—Ä–µ–º—è –¥–ª—è —Å–∞–º–æ—Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è."),
    "X": ("–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã", "–¶–∏–∫–ª—ã, –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Å—É–¥—å–±–∞.",
           "–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —Ü–∏–∫–ª—ã –∂–∏–∑–Ω–∏. –ë—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –∫ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–º—É."),
    "XI": ("–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å", "–ë–∞–ª–∞–Ω—Å, —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ, —á–µ—Å—Ç–Ω–æ—Å—Ç—å.",
            "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å –æ–ª–∏—Ü–µ—Ç–≤–æ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è. –≠—Ç–æ –ø—Ä–∏–∑—ã–≤ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è."),
    "XII": ("–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π", "–°–º–µ–Ω–∞ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤, –∂–µ—Ä—Ç–≤–∞.",
            "–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π –≥–æ–≤–æ—Ä–∏—Ç –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∂–µ—Ä—Ç–≤—ã —Ä–∞–¥–∏ –±–æ–ª—å—à–µ–≥–æ –±–ª–∞–≥–∞. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å–∏—Ç—É–∞—Ü–∏—é —Å –Ω–æ–≤–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è."),
    "XIII": ("–°–º–µ—Ä—Ç—å", "–ö–æ–Ω–µ—Ü, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –Ω–æ–≤–æ–µ –Ω–∞—á–∞–ª–æ.",
             "–°–º–µ—Ä—Ç—å —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –∏ –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ. –≠—Ç–æ –ø—É—Ç—å –∫ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏."),
    "XIV": ("–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å", "–ë–∞–ª–∞–Ω—Å, —Ç–µ—Ä–ø–µ–Ω–∏–µ, –≥–∞—Ä–º–æ–Ω–∏—è.",
             "–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏–∑—ã–≤–∞–µ—Ç –∫ —É–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –≥–∞—Ä–º–æ–Ω–∏–∏. –≠—Ç–æ –∫–∞—Ä—Ç–∞ –±–∞–ª–∞–Ω—Å–∞ –≤ –¥–µ–π—Å—Ç–≤–∏—è—Ö."),
    "XV": ("–î—å—è–≤–æ–ª", "–ü—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏, –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–º, –∏–ª–ª—é–∑–∏—è.",
            "–î—å—è–≤–æ–ª —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –≤–ª–∏—è–Ω–∏—è. –ë—É–¥—å—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã –∫ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–º—É."),
    "XVI": ("–ë–∞—à–Ω—è", "–†–∞–∑—Ä—É—à–µ–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏—è, –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ.",
            "–ë–∞—à–Ω—è –≥–æ–≤–æ—Ä–∏—Ç –æ —Ä–µ–∑–∫–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—é –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ."),
    "XVII": ("–ó–≤–µ–∑–¥–∞", "–ù–∞–¥–µ–∂–¥–∞, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ.",
             "–ó–≤–µ–∑–¥–∞ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–∞–¥–µ–∂–¥—É –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ. –û—â—É–≤—Å—Ç–≤—É–π—Ç–µ —Å–≤–µ—Ç–ª–æ–µ –±—É–¥—É—â–µ–µ."),
    "XVIII": ("–õ—É–Ω–∞", "–°–Ω—ã, –∏–Ω—Ç—É–∏—Ü–∏—è, –æ–±–º–∞–Ω.",
               "–õ—É–Ω–∞ –æ–ª–∏—Ü–µ—Ç–≤–æ—Ä—è–µ—Ç —Ç–∞–π–Ω—ã –∏ –∏–Ω—Ç—É–∏—Ü–∏—é. –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å –∏–ª–ª—é–∑–∏—è–º–∏."),
    "XIX": ("–°–æ–ª–Ω—Ü–µ", "–†–∞–¥–æ—Å—Ç—å, —É—Å–ø–µ—Ö, –∂–∏–∑–Ω–µ–Ω–Ω–∞—è —Å–∏–ª–∞.",
             "–°–æ–ª–Ω—Ü–µ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–¥–æ—Å—Ç—å –∏ —É—Å–ø–µ—Ö. –≠—Ç–æ –≤—Ä–µ–º—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–º–∞ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è."),
    "XX": ("–°—É–¥", "–í–æ—Å—Ö–æ–∂–¥–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –ø—Ä–æ—â–µ–Ω–∏–µ.",
            "–°—É–¥ –æ–ª–∏—Ü–µ—Ç–≤–æ—Ä—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ. –≠—Ç–æ –≤—Ä–µ–º—è –¥–ª—è —Å–∞–º–æ–∞–Ω–∞–ª–∏–∑–æ–≤ –∏ –Ω–æ–≤—ã—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏–π."),
    "XXI": ("–ú–∏—Ä", "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –µ–¥–∏–Ω—Å—Ç–≤–æ, —É—Å–ø–µ—Ö.",
             "–ú–∏—Ä —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏ –≥–∞—Ä–º–æ–Ω–∏—é. –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —Å–≤–æ–∏—Ö —Ü–µ–ª–µ–π.")
}
# –°–ø–∏—Å–æ–∫ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–æ–≤ –∏ –≤–æ–ø—Ä–æ—Å–æ–≤
banned_words = ["–¥—É—Ä–∞–∫", "—Ç—ã", "–∑–∞–≤—Ç—Ä–∞", "—á—Ç–æ –±—É–¥–µ—Ç", "–µ—Å–ª–∏"]
banned_questions = ["–ö–∞–∫ —Å—Ç–∞—Ç—å –±–æ–≥–∞—Ç—ã–º?", "–ö–æ–≥–¥–∞ —è —É–º—Ä—É?", "–ù–∞–ø–∏—à–∏ –º–Ω–µ –±—É–¥—É—â–µ–µ."]

# –û–ø—Ä–µ–¥–µ–ª–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏—è
CHOOSING, QUESTIONING = range(2)
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    keyboard = [
        ["–ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–∫–ª–∞–¥ –Ω–∞ –ª—é–±–æ–≤—å", "–ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–∫–ª–∞–¥ –Ω–∞ –∫–∞—Ä—å–µ—Ä—É"],
        ["–ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–∫–ª–∞–¥ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ", "–û–±—â–∏–π —Ä–∞—Å–∫–ª–∞–¥"]
    ]
    reply_markup = ReplyKeyboardMarkup(keyboard, one_time_keyboard=True, resize_keyboard=True)
    await update.message.reply_text("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ë–æ—Ç–∞ –¢–∞—Ä–æ!üÉè\n–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å–∫–ª–∞–¥:", reply_markup=reply_markup)
    return CHOOSING

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Ä–∞—Å–∫–ª–∞–¥–∞
async def choose_type(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_choice = update.message.text.strip()
    context.user_data['chosen_type'] = user_choice  # –°–æ—Ö—Ä–∞–Ω–∏–º –≤—ã–±–æ—Ä –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
    await update.message.reply_text("–û—Ç–ª–∏—á–Ω–æ! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å:")
    return QUESTIONING

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
async def handle_question(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_question = update.message.text.strip()
    selected_cards = random.sample(list(tarot_cards.items()), 3)

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
    if any(banned_word in user_question for banned_word in banned_words):
        await update.message.reply_text("–í–∞—à –≤–æ–ø—Ä–æ—Å —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–ª–æ–≤–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–¥–∞–π—Ç–µ –¥—Ä—É–≥–æ–π –≤–æ–ø—Ä–æ—Å.")
        return QUESTIONING

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
    if user_question in banned_questions:
        await update.message.reply_text("–í–∞—à –≤–æ–ø—Ä–æ—Å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–¥–∞–π—Ç–µ –¥—Ä—É–≥–æ–π –≤–æ–ø—Ä–æ—Å.")
        return QUESTIONING

    selected_cards = random.sample(list(tarot_cards.items()), 3)

    result = "–í–∞—à —Ä–∞—Å–∫–ª–∞–¥:\n\n"

    for card_num, (card_name, short_desc, full_desc) in selected_cards:
        result += f"{card_name} ({card_num}): {short_desc}\n–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ: {full_desc}\n\n"

    interpretation = interpret_draw(selected_cards)
    result += "–õ–æ–≥–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞: " + interpretation

    # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–∞—Å–∫–ª–∞–¥–∞
    keyboard = [
        ["–ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–∫–ª–∞–¥ –Ω–∞ –ª—é–±–æ–≤—å", "–ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–∫–ª–∞–¥ –Ω–∞ –∫–∞—Ä—å–µ—Ä—É"],
        ["–ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–∫–ª–∞–¥ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ", "–û–±—â–∏–π —Ä–∞—Å–∫–ª–∞–¥"]
    ]
    reply_markup = ReplyKeyboardMarkup(keyboard, one_time_keyboard=True, resize_keyboard=True)

    await update.message.reply_text(result, reply_markup=reply_markup)
    return CHOOSING  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —Ä–∞—Å–∫–ª–∞–¥–∞
# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–∞—Å–∫–ª–∞–¥–∞
def interpret_draw(selected_cards):
    interpretations = []
    for card_num, (card_name, short_desc, full_desc) in selected_cards:
        interpretations.append(full_desc)
    return " ".join(interpretations)

# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
async def main():
    application = ApplicationBuilder().token('7884607985:AAER00ZtUz6U8AAmRGLdL8jIgls6ma7mw1M').build()

    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
    conv_handler = ConversationHandler(
        entry_points=[CommandHandler("start", start)],
        states={
            CHOOSING: [MessageHandler(filters.TEXT & ~filters.COMMAND, choose_type)],
            QUESTIONING: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_question)]
        },
        fallbacks=[]
    )

    application.add_handler(conv_handler)

    # –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    await application.run_polling()

if __name__ == '__main__':
    import asyncio
    asyncio.run(main())